## Bypassing SSRF filters via an open redirect
Sometimes it is possible to bypass filters by exploiting an **open redirect vulnerability**.
In the previous example, assume that the user URL is strictly checked to prevent SSRF exploitation. However, the allowed application has an open redirect vulnerability. If the API for the backend requests supports redirects, it is possible to create a URL that satisfies the filter but leads to the target.
For example, the application has an open redirect where the request:
```URL
/product/nextProduct?currentProductId=6&path=http://evil-user.net
```
redirects to:
```URL
http://evil-user.net
```

This vulnerability can be used to bypass the filter and exploit SSRF:
```Request
POST /product/stock HTTP/1.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 118

stockApi=http://weliketoshop.net/product/nextProduct?currentProductId=6&path=http://192.168.0.68/admin
```

The exploit works because the application first checks that `stockAPI` belongs to an allowed domain (which is true). Then it requests the URL, which triggers the open redirect. The server follows the redirect and accesses the attacker's internal URL.