`Cookies` set to `SameSite=Lax` are generally not sent in cross-site `POST` requests, but there are exceptions.
As we mentioned, if a site does not explicitly specify the `SameSite` attribute when setting a cookie, Chrome defaults to `Lax` mode. However, to avoid breaking single sign-on (SSO) mechanisms, these restrictions are not actually `enforced` for the first 120 seconds of top-level `POST` requests. This creates a two-minute window during which users may be vulnerable to cross-site attacks.

> **Note**  
> This two-minute window does not apply to cookies that were explicitly set with the `SameSite=Lax` attribute.

It is not very practical to time an attack to this short window. On the other hand, if we can find a gadget on the site that allows us to trick the victim into getting a new session cookie, we can update their cookie beforehand and only then perform the main attack. For example, an OAuth login process might result in a new session being issued each time, since the OAuth service does not necessarily know whether the user is logged in to the target site or not.

To trigger a cookie update without requiring manual re-authorization by the victim, we need to use top-level navigation that ensures that the cookies associated with the current OAuth session are included. However, this creates an additional problem, since after the user logs in, we need to return them back to our site to perform the CSRF attack.

An alternative is to trigger a cookie update in a new tab, so that the browser does not leave the page until our attack is complete. The small catch is that browsers block pop-up tabs unless they were opened by manual interaction. For example, the following popup call will be blocked by the browser by default:
```JavaScript
window.open('https://vulnerable-website.com/login/sso');
```
To work around this, you can wrap the statement in an `onclick` event handler, like this:
```JavaScript
window.onclick = () => {
window.open('https://vulnerable-website.com/login/sso');
}
```
This way, the `window.open()` method is only called when the user clicks anywhere on the page, and the popup will not be blocked.