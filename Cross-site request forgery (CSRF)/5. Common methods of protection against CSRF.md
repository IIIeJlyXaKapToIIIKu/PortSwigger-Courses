Today, successfully discovering and exploiting CSRF vulnerabilities often involves bypassing anti-CSRF protections deployed by the target website, the victim's browser, or both. The most common protections you may encounter are listed below:
1. **CSRF tokens.** A CSRF token is a unique, secret, and unpredictable value that is generated by the server application and passed to the client. When attempting to perform a sensitive action, such as submitting a form, the client must include the correct CSRF token in the request. This makes it difficult for an attacker to create a valid request on behalf of the victim.
2. **SameSite cookies.** SameSite is a browser security mechanism that determines when a website's cookies are included in requests originating from other websites. Since requests to perform sensitive actions typically require an authenticated session cookie, appropriate SameSite restrictions can prevent an attacker from initiating these actions cross-site. As of 2021, Chrome enforces SameSite Lax restrictions by default. Since this is a proposed standard, we expect other major browsers to adopt this behavior in the future.
3. **Referer-based validation.** Some applications use the HTTP Referer header to attempt to protect against CSRF attacks, typically by verifying that the request originates from the application's own domain. This is generally less effective than validating CSRF tokens.