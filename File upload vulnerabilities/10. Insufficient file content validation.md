## Insufficient file content validation
Instead of blindly trusting the `Content-Type` header, more secure servers try to check that the file content matches the expected type.

For an image upload feature, the server may check internal properties (such as dimensions). If you try to upload a `PHP script` (which does not have image dimensions), the server will reject the upload.

Similarly, certain file types contain specific byte sequences in the header or trailer. These act as a digital signature to verify the type. For example, `JPEG` files always start with the bytes `FF D8 FF`.

This is a more reliable method, but it is not perfect. Using tools like `ExifTool`, it is possible to create a **polyglot JPEG** file that contains malicious code in the metadata.