## Preventing File Execution in Public Directories

While it is preferable to block dangerous file types from being uploaded in the first place, a second line of defense is to prevent the server from executing scripts that are successfully uploaded.

For security reasons, servers typically only execute scripts with `MIME types` that are explicitly configured to execute. Otherwise, they may return an error or (in some cases) send the file contents as plain text:

```Request
GET /static/exploit.php?command=id HTTP/1.1
Host: normal-website.com
```

```Response
HTTP/1.1 200 OK
Content-Type: text/plain
Content-Length: 39

<?php echo system($_GET['command']); ?>
```

This behavior alone can be useful for leaking source code, but it blocks the creation of a web shell.

Configuration often differs for different directories. The directory for uploaded files is usually strictly limited, unlike other sections of the `filesystem`, which are considered inaccessible to users. If we find a way to upload a script to a directory not intended for user files, the server can execute it.

>[!info] Tip:
Web servers often use the `filename` field in `multipart/form-data` requests to determine the name and location of the file.

>[!important] Important!
>Even if all requests go to the same domain name, it often points to a reverse proxy (e.g., a load balancer). Requests may be processed by different servers in the background, whose configuration may differ.