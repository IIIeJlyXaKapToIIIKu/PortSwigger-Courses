## Exploiting Unrestricted File Uploads to Deploy a Web Shell
From a security perspective, the worst case scenario is when a site allows uploading server-side scripts (e.g. `.php`, `.java`, `.py`) **and** is configured to execute them as code. This makes it trivial to create your own web shell on the server.

>[!info] Note
A web shell is a malicious script that allows an attacker to execute arbitrary commands on a remote web server by sending `HTTP requests` to the desired endpoint.

If the web shell is successfully uploaded, we gain full control over the server. This means the ability to:
* Read and write arbitrary files
* Extract sensitive data
* Use the server to attack internal infrastructure and external systems

For example, this one-line `PHP` reads arbitrary files from the server `filesystem`:
```PHP
<?php echo file_get_contents('/path/to/target/file'); ?>
```
Once loaded, a request to this file will return the target file's content in the response.

A more general web shell might look like this:
```PHP
<?php echo system($_GET['command']); ?>
```
It allows passing arbitrary system commands via a query parameter:
```HTTP
GET /example/exploit.php?command=id HTTP/1.1
```